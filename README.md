# Ransomware

#Part 1: Creation of Ransomware

Creation of a program capable of encrypting directories recursively and acting as ransomware. The 
program will create a random key and will mail this key to an external account. Since symmetric
encryption is much faster than asymmetric encryption, AES with a 128-bit key will be used for 
encryption. The code will be written in Python and the script will be converted to an executable using 
py2exe to hide it as an innocuous executable.

Programming Language: Python.


#Part 2: Delivery of Ransomware
Create a delivery system for this ransomware, developed in part 1, we will create a fake Gmail account 
and send an innocuous email attachment or as an executable, renamed as a genuine software 
installer. The website will host the ransomware program as a popular game installer. Once the user 
downloads the game and runs it, the program will infect the user machine.

#Part 3: Ransomware Detection
Detection of any suspicious activity in the file system by checking for signatures and raising an alarm. 
The detection will be done through setting up of perimeter/honeytrap files. Special files, called 
perimeter files, will be created in all directories. If a ransomware lists files in any directory, the first file 
that will come up are these special files. 

When the ransomware encrypts a perimeter file, an alarm is generated by the monitoring processes 
which has a list of all these files. The prevention and recovery are then initiated. The code for this 
stage will run as a monitor in the system. If these files are changed/encrypted, it implies that there is 
virus active on the system. The file monitoring will be done in Python using OS and watchdog libraries.

#Part 4: Attack Prevention/Disruption
This part includes the following steps to shutting down the system network to avoid spreading of the ransomware further:

1. Kill all active processes (including the ransomware)
2. Stop the networking service on the system
3. Initiate shutdown (Requires superuser approval and privileges). 

The code for this stage will run as a part of monitor in Part 3 above and will require superuser approval. 
On windows, OS module will be used to achieve this functionality. The procedure may be different for 
windows and may involve the task kill command. This will be achieved through python script only.

#Part 5: Recovery/Mitigation. 

It will not be possible to decrypt the files since the encryption used is very string, but the system will 
scan the folders for ransomware and will try to detect any new files that were created after the time 
of attack and delete them. This usually can be done after the affected filesystem is mounted on 
another system. It is risky to turn on the same system as the ransomware may continue the process 
of infecting. The recovery system will try to restore all files unmodified since the time of attack.

References:
1. D. Gonzalez and T. Hayajneh, "Detection and prevention of crypto-ransomware," 2017 IEEE 8th 
Annual Ubiquitous Computing, Electronics and Mobile Communication Conference (UEMCON), 2017, 
pp. 472-478, doi: 10.1109/UEMCON.2017.8249052. 
2. crypto ransom: whatâ€™s that? by Kent, Link: Crypto Ransomware: What's That? - Document 
Management System Folder it.
